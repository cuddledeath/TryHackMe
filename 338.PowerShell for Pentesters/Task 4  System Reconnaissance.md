While several PowerShell scripts are readily available for reconnaissance, these may be flagged by the antivirus installed on the target system.

**Finding Missing Patches**

The patch level of the target system will have an impact on the steps following the initial compromise. Having an idea about the potentially missing patches could help the red teamer identify a possible privilege escalation path or even provide further information about the target system.

The “`Get-Hotfix`” command can be used to enumerate already installed patches.

![](https://i.imgur.com/TFN751h.png)  

To make things easier, we could output the result of the Get-Hotfix command in a list format and grep it further using the “`findstr`” command. The example below shows how the installation date of patches could be listed to have a better idea about update cycles on the target.

![](https://i.imgur.com/q2h46G0.png)  

By default, the “`Get-HotFix`” command will show the output in a table format. This table can be useful to list only data provided in a column without the need to use “`findstr`” using “Format-Table” followed by the name of the column we are interested in. The example below shows the output listing only HotFixIDs.

![](https://i.imgur.com/Ayp8vHa.png)  

“`Format-List`” can also be used to gather more information about objects. Below are three examples using a simple “`dir`” command.

![](https://i.imgur.com/W1JwD0r.png)  

![](https://i.imgur.com/qFiTxJX.png)  

![](https://i.imgur.com/quYAfzn.png)  

As you can see, we can access even more information about the file (such as the CreationTime, Last AccessTime, LastWriteTime) using a wildcard after “`Format-List`” to show all available information.

At any stage, “`Out-File`” can be used to save the output to a file for further use.

![](https://i.imgur.com/95opPtk.png)  

“`Get-Content`” could also be used to read the file's content just as “type” shown in the example above. Several other output formats are available, including the beautiful GridView option.

![](https://i.imgur.com/Knhu1eF.png)  

The GridView option provides a nice GUI with sortable columns for any output that can be overwhelming on the CLI.

![](https://i.imgur.com/mCpTkvx.png)  

Answer the questions below

What Windows Security Update was installed on 5/15/2019?

	KB4499728

```
powershell Get-HotFix
```

![[Pasted image 20220416110242.png]]

