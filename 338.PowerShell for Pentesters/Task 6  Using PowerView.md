PowerView is one of the most effective ways to gather information on the domain. The module can be downloaded from [https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1](https://github.com/PowerShellMafia/PowerSploit/blob/dev/Recon/PowerView.ps1)

  

Remember that you may need to bypass the execution policy to be able to run the script.

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/28c31bddc102d52ee59be489eb60a169.png)  

  

  

We can now use `PowerView.ps1` to obtain more information on the domain configuration and users.

  

  

**Get-NetDomainController**

  
This command will collect information on the domain controller.

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/4408c1d490fdae3e263354fbaf303bdb.png)  

  

Knowing the IP address of the domain controller will be useful to conduct man-in-the-middle attacks and to focus our efforts on high-value targets.

  

**Get-NetUser**

  
This command will provide a list of domain users. The output can be intimidating, so you may consider exporting the output to a .csv file or use the `out-gridview`option.

  

![](https://i.imgur.com/VN6lJ8p.png)

  

  

The output can also be limited by providing the name of the criteria we are interested in.

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/557a20423a86c31faaadca6a9ec1524c.png)  

  

  

  

Values for a specific property can be listed. For example, if we wanted to list users' last logon dates and times we could use the "Get-NetUser | select -ExpandProperty lastlogon" command.  

  

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/4803f8425988d01213ee948600782652.png)  

  

  

The same command can be modified to select the "description" field instead of "lastlogon" to see if any description was added to accounts.

  

  

  

**Get-NetComputer**

  
This command is useful to enumerate systems connected to the domain. This command can also be used with the “`-ping`” parameter to enumerate the systems that are currently online.

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/2097f772a13cfeaa5d0fcffc864eed5f.png)  

  

  

As you can see in the screenshot above, there are four systems on the domain, but only two of them are online.

  

**Get-NetGroup**

  
Some accounts can be members of important groups, such as domain admins. Knowing which accounts have useful privileges or are a member of groups of interest will be useful for lateral movement and privilege escalation. The “`Get-NetGroup`” command will help us enumerate existing groups.

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/df3ab6ee36fcb9435d72c23029fa3890.png)  

  

  

This will be used to enumerate members of the group using “`Get-NetGroupMember`” followed by "`Domain Admins`".

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/006fd2925701bf733b166f85d4cf2606.png)  

  

  

  

**Finding shares**

  

“`Find-DomainShare`” will list available shares. Please note we have added the "`-CheckShareAccess`" option to list only readable shares.  

  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/d69627e8696dd2fa0d989ec01e981940.png)  

  

  

**Enumerate Group Policy**

Group Policy is used to configure computers connected to the domain. The “`Get-NetGPO`” command will gather information on enforced policies.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/4ef4e229e81c16d45f88cea5eb15cdbd.png)  

Spending some time understanding what policies are set can provide potential attack vectors (is Windows Defender disabled? Is the firewall disabled? Etc.)

The domain you are testing can have a trust relationship with another domain. If this is the case, you may be able to extend the scope of the reconnaissance to that domain. The “`Get-NetDomainTrust`” command will list any domain you may access. For most of the PowerView commands, all you need to do is to add the “`-Domain`” parameter followed by the name of the other domain (e.g. `Get-NetUsers -Domain infra.munn.local`)

**User Enumeration**

Knowing which systems the current user can access with local administrator privileges can facilitate lateral movement. The “`Find-LocalAdminAccess`” command will list systems in the domain you may access as a local administrator.

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/603df7900d7b6f1dff18b0bd/room-content/a23de003ffb03916c9364905633af907.png)  

A good source for PowerView usage can be found [here](https://book.hacktricks.xyz/windows/basic-powershell-for-pentesters/powerview).  

Answer the questions below

One of the accounts has a special description; what is it?  

	IDF-17828290
	
How many accounts are disabled?  

	4
	
How many users are in the "domain admins" group?  

	3

Which users are in the "domain admins" group? (Listed alphabetically, small, comma-separated, using space)  

	ServerAdmin,ssilk,usand

List shares; what is the name of the "interesting" share?

	operationfiles

What is the name of the user-created Group Policy?  

	Disable WinDef

What are the first names of users' whose accounts were disabled? (Sorted alphabetically, small, comma-separated, using space)

	daniel, ursula

```
ssh walter@10.10.235.75
Kowacs123!

powershell

cd Desktop

Import-Module .\powerview.ps1
```


```powershell
(Get-NetUser).name

ServerAdmin
Guest
Walter
sshd
krbtgt
Laurie Jupyter
John Osterman
Adrian Wait
Edward Bake
Sally Silk
Ursula Sand
Daniel Triberg
```

```
(Get-NetUser).description

Built-in account for administering the computer/domain
Built-in account for guest access to the computer/domain
Key Distribution Center Service Account
IDF-17828290

```

```
Get-NetGroupMember "Domain Admins"

GroupDomain             : WATCH.local
GroupName               : Domain Admins
GroupDistinguishedName  : CN=Domain Admins,OU=Groups,DC=WATCH,DC=local
MemberDomain            : WATCH.local
MemberName              : usand
MemberDistinguishedName : CN=Ursula Sand,CN=Users,DC=WATCH,DC=local
MemberObjectClass       : user
MemberSID               : S-1-5-21-1966530601-3185510712-10604624-1119

GroupDomain             : WATCH.local
GroupName               : Domain Admins
GroupDistinguishedName  : CN=Domain Admins,OU=Groups,DC=WATCH,DC=local
MemberDomain            : WATCH.local
MemberName              : ssilk
MemberDistinguishedName : CN=Sally Silk,CN=Users,DC=WATCH,DC=local
MemberObjectClass       : user
MemberSID               : S-1-5-21-1966530601-3185510712-10604624-1118

GroupDomain             : WATCH.local
GroupName               : Domain Admins
GroupDistinguishedName  : CN=Domain Admins,OU=Groups,DC=WATCH,DC=local
MemberDomain            : WATCH.local
MemberName              : ServerAdmin
MemberDistinguishedName : CN=ServerAdmin,CN=Users,DC=WATCH,DC=local
MemberObjectClass       : user
MemberSID               : S-1-5-21-1966530601-3185510712-10604624-500
```

```
(Get-NetGroupMember "Domain Admins").count
3
```

```
(Get-NetGroupMember "Domain Admins").membername
usand
ssilk
ServerAdmin
```

```
Find-DomainShare -CheckShareAccess

Name                 Type Remark              ComputerName
----                 ---- ------              ------------
ADMIN$         2147483648 Remote Admin        WATCHMAN-DC.WATCH.local
C$             2147483648 Default share       WATCHMAN-DC.WATCH.local
NETLOGON                0 Logon server share  WATCHMAN-DC.WATCH.local
operationfiles          0                     WATCHMAN-DC.WATCH.local
SYSVOL                  0 Logon server share  WATCHMAN-DC.WATCH.local
```

```
Get-NetGPO

usncreated               : 12900
displayname              : Disable WinDef
gpcmachineextensionnames : [{35378EAC-683F-11D2-A89A-00C04FBBCFA2}{D02B1F72-3407-48AE-BA88-E8213C6761F
                           1}]
whenchanged              : 5/15/2021 11:21:46 AM
objectclass              : {top, container, groupPolicyContainer}
gpcfunctionalityversion  : 2
showinadvancedviewonly   : True
usnchanged               : 12909
dscorepropagationdata    : 1/1/1601 12:00:00 AM
name                     : {B3BCB206-765F-437E-9826-7F77743EC6C2}
flags                    : 0
cn                       : {B3BCB206-765F-437E-9826-7F77743EC6C2}
gpcfilesyspath           : \\WATCH.local\SysVol\WATCH.local\Policies\{B3BCB206-765F-437E-9826-7F77743E
                           C6C2}
distinguishedname        : CN={B3BCB206-765F-437E-9826-7F77743EC6C2},CN=Policies,CN=System,DC=WATCH,DC
                           =local
whencreated              : 5/15/2021 11:19:39 AM
versionnumber            : 1
instancetype             : 4
objectguid               : bd95654f-37c3-4003-83d4-da7a893eb989
objectcategory           : CN=Group-Policy-Container,CN=Schema,CN=Configuration,DC=WATCH,DC=local
```

```
(Get-NetUser).cn

ServerAdmin
Guest
Walter
sshd
krbtgt
Laurie Jupyter
John Osterman
Adrian Wait
Edward Bake
Sally Silk
Ursula Sand
Daniel Triberg
```

```
(Get-NetUser).useraccountcontrol

NORMAL_ACCOUNT
ACCOUNTDISABLE, PASSWD_NOTREQD, NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
ACCOUNTDISABLE, NORMAL_ACCOUNT
NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
NORMAL_ACCOUNT
NORMAL_ACCOUNT
NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
ACCOUNTDISABLE, NORMAL_ACCOUNT, DONT_EXPIRE_PASSWORD
ACCOUNTDISABLE, PASSWD_NOTREQD, NORMAL_ACCOUNT
```

```
Get-NetDomainController

Get-NetComputer -ping
```